<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Relayä¼æ¥­ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³è¨ºæ–­ãƒ†ã‚¹ãƒˆ</title>
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Hiragino Sans', 'Yu Gothic', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .test-container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            margin-bottom: 30px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 4px;
        }
        
        .question {
            display: none;
            animation: fadeIn 0.5s ease-in;
        }
        
        .question.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .question h3 {
            color: #4a5568;
            margin-bottom: 20px;
            font-size: 1.3rem;
        }
        
        .options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .option {
            background: #f7fafc;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .option:hover {
            background: #edf2f7;
            border-color: #667eea;
        }
        
        .option.selected {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }
        
        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }
        
        .btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            transition: background 0.3s ease;
        }
        
        .btn:hover {
            background: #5a67d8;
        }
        
        .btn:disabled {
            background: #a0aec0;
            cursor: not-allowed;
        }
        
        .results {
            display: none;
            text-align: center;
        }
        
        .score-circle {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: conic-gradient(#667eea 0deg, #667eea var(--score-angle), #e2e8f0 var(--score-angle));
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px auto;
            position: relative;
        }
        
        .score-circle::before {
            content: '';
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: white;
            position: absolute;
        }
        
        .score-text {
            position: relative;
            z-index: 1;
            font-size: 2rem;
            font-weight: bold;
            color: #667eea;
        }
        
        .recommendation {
            background: #f0f8ff;
            border-left: 4px solid #667eea;
            padding: 20px;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .plan-suggestion {
            background: #e8f5e8;
            border: 2px solid #48bb78;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .estimate {
            background: #fff5f5;
            border: 2px solid #f56565;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .contact-form {
            background: #f7fafc;
            border-radius: 8px;
            padding: 20px;
            margin-top: 30px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #4a5568;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #e2e8f0;
            border-radius: 4px;
            font-size: 1rem;
        }
        
        .form-row {
            display: flex;
            gap: 15px;
        }
        
        .form-row .form-group {
            flex: 1;
        }
        
        @media (max-width: 768px) {
            .form-row {
                flex-direction: column;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .test-container {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ä¼æ¥­ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³è¨ºæ–­ãƒ†ã‚¹ãƒˆ</h1>
            <p>ã‚ãªãŸã®ä¼šç¤¾ã®ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³èª²é¡Œã‚’è¨ºæ–­ã—ã€æœ€é©ãªRelayãƒ—ãƒ©ãƒ³ã‚’ã”ææ¡ˆã—ã¾ã™</p>
        </div>
        
        <div class="test-container">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            
            <div id="questionsContainer">
                <div class="question active" data-question="1">
                    <h3>Q1. å¾¡ç¤¾ã®å¾“æ¥­å“¡æ•°ã¯ã©ã®ãã‚‰ã„ã§ã™ã‹ï¼Ÿ</h3>
                    <div class="options">
                        <div class="option" data-value="1">10åä»¥ä¸‹</div>
                        <div class="option" data-value="2">11-30å</div>
                        <div class="option" data-value="3">31-100å</div>
                        <div class="option" data-value="4">101åä»¥ä¸Š</div>
                    </div>
                </div>
                
                <div class="question" data-question="2">
                    <h3>Q2. ç¾åœ¨ã®ç¤¾å†…ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ã¤ã„ã¦ã€ã©ã®ç¨‹åº¦æº€è¶³ã—ã¦ã„ã¾ã™ã‹ï¼Ÿ</h3>
                    <div class="options">
                        <div class="option" data-value="1">éå¸¸ã«æº€è¶³ã—ã¦ã„ã‚‹</div>
                        <div class="option" data-value="2">ã¾ã‚æº€è¶³ã—ã¦ã„ã‚‹</div>
                        <div class="option" data-value="3">ã‚„ã‚„ä¸æº€ãŒã‚ã‚‹</div>
                        <div class="option" data-value="4">å¤§ã„ã«ä¸æº€ãŒã‚ã‚‹</div>
                    </div>
                </div>
                
                <div class="question" data-question="3">
                    <h3>Q3. å¹´ã«ä½•å›ç¨‹åº¦ã€ç¤¾å†…ã‚¤ãƒ™ãƒ³ãƒˆï¼ˆæ‡‡è¦ªä¼šãƒ»ãƒ¬ã‚¯ãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ç­‰ï¼‰ã‚’é–‹å‚¬ã—ã¦ã„ã¾ã™ã‹ï¼Ÿ</h3>
                    <div class="options">
                        <div class="option" data-value="1">é–‹å‚¬ã—ã¦ã„ãªã„</div>
                        <div class="option" data-value="2">å¹´1-2å›</div>
                        <div class="option" data-value="3">å¹´3-6å›</div>
                        <div class="option" data-value="4">æœˆ1å›ä»¥ä¸Š</div>
                    </div>
                </div>
                
                <div class="question" data-question="4">
                    <h3>Q4. ç¾åœ¨è¡Œã£ã¦ã„ã‚‹ç¤¾å†…ã‚¤ãƒ™ãƒ³ãƒˆã§æœ€ã‚‚å¤šã„ã®ã¯ã©ã®ã‚¿ã‚¤ãƒ—ã§ã™ã‹ï¼Ÿ</h3>
                    <div class="options">
                        <div class="option" data-value="1">é£²ã¿ä¼šãƒ»æ‡‡è¦ªä¼š</div>
                        <div class="option" data-value="2">ãƒœãƒ¼ãƒªãƒ³ã‚°ãƒ»ã‚«ãƒ©ã‚ªã‚±</div>
                        <div class="option" data-value="3">ã‚¹ãƒãƒ¼ãƒ„ç³»ã‚¤ãƒ™ãƒ³ãƒˆ</div>
                        <div class="option" data-value="4">ç‰¹ã«æ±ºã¾ã£ãŸå½¢å¼ã¯ãªã„</div>
                    </div>
                </div>
                
                <div class="question" data-question="5">
                    <h3>Q5. ç¤¾å†…ã‚¤ãƒ™ãƒ³ãƒˆã§ã®èª²é¡Œã¯ä½•ã§ã™ã‹ï¼Ÿï¼ˆæœ€ã‚‚å½“ã¦ã¯ã¾ã‚‹ã‚‚ã®ï¼‰</h3>
                    <div class="options">
                        <div class="option" data-value="1">å‚åŠ ç‡ãŒä½ã„</div>
                        <div class="option" data-value="2">ä¼ç”»ãŒãƒãƒ³ãƒãƒªåŒ–ã—ã¦ã„ã‚‹</div>
                        <div class="option" data-value="3">æº–å‚™ã®è² æ‹…ãŒå¤§ãã„</div>
                        <div class="option" data-value="4">ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³åŠ¹æœãŒæ„Ÿã˜ã‚‰ã‚Œãªã„</div>
                    </div>
                </div>
                
                <div class="question" data-question="6">
                    <h3>Q6. ãƒªãƒ¢ãƒ¼ãƒˆãƒ¯ãƒ¼ã‚¯ã®å°å…¥çŠ¶æ³ã¯ã„ã‹ãŒã§ã™ã‹ï¼Ÿ</h3>
                    <div class="options">
                        <div class="option" data-value="1">å®Œå…¨å‡ºç¤¾åˆ¶</div>
                        <div class="option" data-value="2">ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ï¼ˆå‡ºç¤¾ã¨ãƒªãƒ¢ãƒ¼ãƒˆã®çµ„ã¿åˆã‚ã›ï¼‰</div>
                        <div class="option" data-value="3">åŸå‰‡ãƒªãƒ¢ãƒ¼ãƒˆãƒ¯ãƒ¼ã‚¯</div>
                        <div class="option" data-value="4">éƒ¨ç½²ã«ã‚ˆã£ã¦ç•°ãªã‚‹</div>
                    </div>
                </div>
                
                <div class="question" data-question="7">
                    <h3>Q7. æ¡ç”¨æ´»å‹•ã«ãŠã„ã¦ã€ã©ã®ã‚ˆã†ãªèª²é¡Œã‚’ãŠæ„Ÿã˜ã§ã™ã‹ï¼Ÿ</h3>
                    <div class="options">
                        <div class="option" data-value="1">å¿œå‹Ÿè€…ãŒå°‘ãªã„</div>
                        <div class="option" data-value="2">ä¼æ¥­æ–‡åŒ–ãŒä¼ã‚ã‚Šã«ãã„</div>
                        <div class="option" data-value="3">è‹¥æ‰‹ã®å®šç€ç‡ãŒä½ã„</div>
                        <div class="option" data-value="4">ç‰¹ã«èª²é¡Œã¯æ„Ÿã˜ã¦ã„ãªã„</div>
                    </div>
                </div>
                
                <div class="question" data-question="8">
                    <h3>Q8. ç¤¾å†…ã‚¤ãƒ™ãƒ³ãƒˆã®äºˆç®—ã¨ã—ã¦ã€å¹´é–“ã©ã®ç¨‹åº¦ã‚’æƒ³å®šã•ã‚Œã¦ã„ã¾ã™ã‹ï¼Ÿ</h3>
                    <div class="options">
                        <div class="option" data-value="1">20ä¸‡å††æœªæº€</div>
                        <div class="option" data-value="2">20-50ä¸‡å††</div>
                        <div class="option" data-value="3">50-100ä¸‡å††</div>
                        <div class="option" data-value="4">100ä¸‡å††ä»¥ä¸Š</div>
                    </div>
                </div>
                
                <div class="question" data-question="9">
                    <h3>Q9. æ–°ã—ã„å½¢ã®ç¤¾å†…ãƒ¬ã‚¯ãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ã«å¯¾ã™ã‚‹é–¢å¿ƒåº¦ã¯ã„ã‹ãŒã§ã™ã‹ï¼Ÿ</h3>
                    <div class="options">
                        <div class="option" data-value="1">éå¸¸ã«é–¢å¿ƒãŒã‚ã‚‹</div>
                        <div class="option" data-value="2">ã‚„ã‚„é–¢å¿ƒãŒã‚ã‚‹</div>
                        <div class="option" data-value="3">ã‚ã¾ã‚Šé–¢å¿ƒãŒãªã„</div>
                        <div class="option" data-value="4">ç¾çŠ¶ç¶­æŒã§ååˆ†</div>
                    </div>
                </div>
                
                <div class="question" data-question="10">
                    <h3>Q10. æ˜ åƒåˆ¶ä½œï¼ˆæ¡ç”¨PRå‹•ç”»ãªã©ï¼‰ã¸ã®é–¢å¿ƒã¯ã„ã‹ãŒã§ã™ã‹ï¼Ÿ</h3>
                    <div class="options">
                        <div class="option" data-value="1">éå¸¸ã«é–¢å¿ƒãŒã‚ã‚‹</div>
                        <div class="option" data-value="2">ã‚„ã‚„é–¢å¿ƒãŒã‚ã‚‹</div>
                        <div class="option" data-value="3">ã‚ã¾ã‚Šé–¢å¿ƒãŒãªã„</div>
                        <div class="option" data-value="4">ä¸è¦ã ã¨æ€ã†</div>
                    </div>
                </div>
            </div>
            
            <div class="navigation">
                <button class="btn" id="prevBtn" onclick="previousQuestion()" disabled>å‰ã¸</button>
                <button class="btn" id="nextBtn" onclick="nextQuestion()" disabled>æ¬¡ã¸</button>
            </div>
            
            <div class="results" id="results">
                <h2>è¨ºæ–­çµæœ</h2>
                <div class="score-circle" id="scoreCircle">
                    <div class="score-text" id="scoreText">0%</div>
                </div>
                
                <div class="recommendation" id="recommendation"></div>
                <div class="plan-suggestion" id="planSuggestion"></div>
                <div class="estimate" id="estimate"></div>
                
                <div class="contact-form">
                    <h3>è©³ç´°ãªã”ç›¸è«‡ã‚’ã”å¸Œæœ›ã®æ–¹</h3>
                    <p>è¨ºæ–­çµæœã‚’ã‚‚ã¨ã«ã€ZOOMã¾ãŸã¯è¨ªå•ã§ã®è©³ç´°æ‰“åˆã›ã‚’æ‰¿ã‚Šã¾ã™</p>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>ä¼šç¤¾å *</label>
                            <input type="text" id="companyName" required>
                        </div>
                        <div class="form-group">
                            <label>ãŠåå‰ *</label>
                            <input type="text" id="contactName" required>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ *</label>
                            <input type="email" id="email" required>
                        </div>
                        <div class="form-group">
                            <label>é›»è©±ç•ªå·</label>
                            <input type="tel" id="phone">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>å¸Œæœ›ã™ã‚‹æ‰“åˆã›æ–¹æ³•</label>
                        <select id="meetingType">
                            <option value="zoom">ZOOMä¼šè­°</option>
                            <option value="visit">è¨ªå•æ‰“åˆã›</option>
                            <option value="both">ãƒ¡ãƒ¼ãƒ«ã§ç°¡æ˜“è¦‹ç©ã‚‚ã‚Šå¸Œæœ›</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>ã”è³ªå•ãƒ»ã”è¦æœ›</label>
                        <textarea id="message" rows="4" placeholder="è¨ºæ–­çµæœã«ã¤ã„ã¦ã€å…·ä½“çš„ãªå®Ÿæ–½æ™‚æœŸã€ãã®ä»–ã”è³ªå•ãªã©"></textarea>
                    </div>
                    
                    <button class="btn" onclick="submitContactForm()" style="width: 100%; margin-top: 20px;">
                        è©³ç´°æ‰“åˆã›ã‚’ç”³ã—è¾¼ã‚€
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentQuestion = 1;
        let totalQuestions = 10;
        let answers = {};
        
        function updateProgress() {
            const progress = (currentQuestion / totalQuestions) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
        }
        
        function showQuestion(questionNumber) {
            document.querySelectorAll('.question').forEach(q => q.classList.remove('active'));
            document.querySelector(`[data-question="${questionNumber}"]`).classList.add('active');
            
            document.getElementById('prevBtn').disabled = questionNumber === 1;
            
            if (questionNumber === totalQuestions) {
                document.getElementById('nextBtn').textContent = 'çµæœã‚’è¦‹ã‚‹';
            } else {
                document.getElementById('nextBtn').textContent = 'æ¬¡ã¸';
            }
            
            document.getElementById('nextBtn').disabled = !answers[questionNumber];
        }
        
        function nextQuestion() {
            if (currentQuestion < totalQuestions) {
                currentQuestion++;
                showQuestion(currentQuestion);
                updateProgress();
            } else {
                showResults();
            }
        }
        
        function previousQuestion() {
            if (currentQuestion > 1) {
                currentQuestion--;
                showQuestion(currentQuestion);
                updateProgress();
            }
        }
        
        function showResults() {
            document.getElementById('questionsContainer').style.display = 'none';
            document.querySelector('.navigation').style.display = 'none';
            document.getElementById('results').style.display = 'block';
            
            calculateResults();
        }
        
        function calculateResults() {
            let score = 0;
            let maxScore = 0;
            
            Object.keys(answers).forEach(q => {
                const answer = parseInt(answers[q]);
                if (q == 1) {
                    score += answer * 2;
                    maxScore += 8;
                } else if (q == 2) {
                    score += (5 - answer) * 3;
                    maxScore += 12;
                } else if (q == 5) {
                    score += answer * 2;
                    maxScore += 8;
                } else if (q == 9 || q == 10) {
                    score += answer * 2;
                    maxScore += 8;
                } else {
                    score += answer;
                    maxScore += 4;
                }
            });
            
            const finalScore = Math.round((score / maxScore) * 100);
            
            document.getElementById('scoreText').textContent = finalScore + '%';
            document.getElementById('scoreCircle').style.setProperty('--score-angle', (finalScore * 3.6) + 'deg');
            
            generateRecommendation(finalScore);
        }
        
        function generateRecommendation(score) {
            let recommendation = '';
            let planSuggestion = '';
            let estimate = '';
            
            if (score >= 75) {
                recommendation = `
                    <h4>ğŸ¯ é«˜ã„æ”¹å–„ãƒ‹ãƒ¼ã‚ºãŒè¨ºæ–­ã•ã‚Œã¾ã—ãŸ</h4>
                    <p>å¾¡ç¤¾ã¯ç¤¾å†…ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®æ”¹å–„ã«ç©æ¥µçš„ã§ã€æ–°ã—ã„å–ã‚Šçµ„ã¿ã¸ã®é–¢å¿ƒã‚‚é«˜ã„ã“ã¨ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚
                    Relayã®å¤šè§’çš„ãªã‚¢ãƒ—ãƒ­ãƒ¼ãƒãŒã€å¾¡ç¤¾ã®æ›´ãªã‚‹ç™ºå±•ã«å¤§ããè²¢çŒ®ã§ãã‚‹ã¨è€ƒãˆã¾ã™ã€‚</p>
                `;
                planSuggestion = `
                    <h4>ğŸŒŸ æ¨å¥¨ãƒ—ãƒ©ãƒ³ï¼šãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ—ãƒ©ãƒ³</h4>
                    <p><strong>ç†ç”±ï¼š</strong> æ˜ åƒåˆ¶ä½œã«ã‚ˆã‚‹æ¡ç”¨PRå¼·åŒ–ã¨ã‚¢ã‚¹ãƒªãƒ¼ãƒˆæ´¾é£ã«ã‚ˆã‚‹ç‰¹åˆ¥æ„Ÿã®ã‚ã‚‹ã‚¤ãƒ™ãƒ³ãƒˆã§ã€
                    ç¤¾å†…å¤–ã¸ã®åŠ¹æœçš„ãªç™ºä¿¡ãŒå¯èƒ½ã§ã™ã€‚</p>
                    <ul style="text-align: left; margin: 10px 0; padding-left: 20px;">
                        <li>ãƒ¬ã‚¯ãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿæ–½ï¼ˆ5æ™‚é–“ç¨‹åº¦ï¼‰</li>
                        <li>æ¡ç”¨ãƒ»ç¤¾å†…å ±ç”¨å‹•ç”»åˆ¶ä½œ</li>
                        <li>ã‚¢ã‚¹ãƒªãƒ¼ãƒˆæ´¾é£</li>
                        <li>MCãƒ»é€²è¡Œã‚µãƒãƒ¼ãƒˆ</li>
                    </ul>
                `;
                estimate = `
                    <h4>ğŸ’° ãŠè¦‹ç©ã‚Šã«ã¤ã„ã¦</h4>
                    <p>ãŠå®¢æ§˜ã®äºˆç®—ã¨ã”è¦æœ›ã«åˆã‚ã›ãŸè©³ç´°ãªãŠè¦‹ç©ã‚Šã‚’ã”ææ¡ˆã„ãŸã—ã¾ã™ã€‚</p>
                    <p>ãŠæ°—è»½ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚</p>
                `;
            } else if (score >= 50) {
                recommendation = `
                    <h4>âš¡ ä¸­ç¨‹åº¦ã®æ”¹å–„åŠ¹æœãŒæœŸå¾…ã§ãã¾ã™</h4>
                    <p>å¾¡ç¤¾ã§ã¯æ—¢å­˜ã®å–ã‚Šçµ„ã¿ã‚’ãƒ™ãƒ¼ã‚¹ã«ã€ã‚ˆã‚ŠåŠ¹æœçš„ãªã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³å‘ä¸Šç­–ã‚’
                    å°å…¥ã™ã‚‹ã“ã¨ã§å¤§ããªå¤‰åŒ–ã‚’å®Ÿæ„Ÿã—ã¦ã„ãŸã ã‘ã‚‹ã¨æ€ã„ã¾ã™ã€‚</p>
                `;
                planSuggestion = `
                    <h4>âœ¨ æ¨å¥¨ãƒ—ãƒ©ãƒ³ï¼šã‚¹ã‚¿ãƒ³ãƒ€ãƒ¼ãƒ‰ãƒ—ãƒ©ãƒ³</h4>
                    <p><strong>ç†ç”±ï¼š</strong> ååˆ†ãªæ™‚é–“ã‚’ã‹ã‘ã¦ã—ã£ã‹ã‚Šã¨ã—ãŸäº¤æµã‚’å›³ã‚ŠãªãŒã‚‰ã€
                    ã‚³ã‚¹ãƒˆãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®è‰¯ã„æ”¹å–„åŠ¹æœã‚’å®Ÿç¾ã§ãã¾ã™ã€‚</p>
                    <ul style="text-align: left; margin: 10px 0; padding-left: 20px;">
                        <li>ãƒ¬ã‚¯ãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿæ–½ï¼ˆ5æ™‚é–“ç¨‹åº¦ï¼‰</li>
                        <li>æ˜¼é£Ÿã‚’æŒŸã‚“ã å……å®Ÿãƒ—ãƒ­ã‚°ãƒ©ãƒ </li>
                        <li>ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆãƒ»åŠ¹æœæ¸¬å®š</li>
                        <li>ã‚¢ã‚¹ãƒªãƒ¼ãƒˆæ´¾é£ã‚ªãƒ—ã‚·ãƒ§ãƒ³</li>
                    </ul>
                `;
                estimate = `
                    <h4>ğŸ’° ãŠè¦‹ç©ã‚Šã«ã¤ã„ã¦</h4>
                    <p>ãŠå®¢æ§˜ã®äºˆç®—ã¨ã”è¦æœ›ã«åˆã‚ã›ãŸè©³ç´°ãªãŠè¦‹ç©ã‚Šã‚’ã”ææ¡ˆã„ãŸã—ã¾ã™ã€‚</p>
                    <p>ãŠæ°—è»½ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚</p>
                `;
            } else {
                recommendation = `
                    <h4>ğŸŒ± ã‚¹ãƒ¢ãƒ¼ãƒ«ã‚¹ã‚¿ãƒ¼ãƒˆãŒãŠã™ã™ã‚ã§ã™</h4>
                    <p>ã¾ãšã¯æ°—è»½ã«ä½“é¨“ã—ã¦ã„ãŸã ã‘ã‚‹ãƒ—ãƒ©ãƒ³ã‹ã‚‰å§‹ã‚ã¦ã€åŠ¹æœã‚’å®Ÿæ„Ÿã—ã¦ã„ãŸã ã„ãŸå¾Œã«
                    æœ¬æ ¼å°å…¥ã‚’ã”æ¤œè¨ã„ãŸã ãã®ãŒè‰¯ã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚</p>
                `;
                planSuggestion = `
                    <h4>ğŸš€ æ¨å¥¨ãƒ—ãƒ©ãƒ³ï¼šãƒ©ã‚¤ãƒˆãƒ—ãƒ©ãƒ³</h4>
                    <p><strong>ç†ç”±ï¼š</strong> ãƒˆãƒ©ã‚¤ã‚¢ãƒ«å°å…¥ã¨ã—ã¦æœ€é©ã§ã€çŸ­æ™‚é–“ã§æ°—è»½ã«æ–°ã—ã„
                    ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³æ‰‹æ³•ã‚’ä½“é¨“ã—ã¦ã„ãŸã ã‘ã¾ã™ã€‚</p>
                    <ul style="text-align: left; margin: 10px 0; padding-left: 20px;">
                        <li>ãƒ¬ã‚¯ãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿæ–½ï¼ˆ3æ™‚é–“ç¨‹åº¦ï¼‰</li>
                        <li>åˆå‰ã¾ãŸã¯åˆå¾Œã®ã‚·ãƒ§ãƒ¼ãƒˆãƒ—ãƒ­ã‚°ãƒ©ãƒ </li>
                        <li>åŠ¹æœæ¸¬å®šãƒ»å ±å‘Šæ›¸ä½œæˆ</li>
                    </ul>
                `;
                estimate = `
                    <h4>ğŸ’° ãŠè¦‹ç©ã‚Šã«ã¤ã„ã¦</h4>
                    <p>ãŠå®¢æ§˜ã®äºˆç®—ã¨ã”è¦æœ›ã«åˆã‚ã›ãŸè©³ç´°ãªãŠè¦‹ç©ã‚Šã‚’ã”ææ¡ˆã„ãŸã—ã¾ã™ã€‚</p>
                    <p>ä½“é¨“ä¼šã‚‚ã”ç”¨æ„ã—ã¦ãŠã‚Šã¾ã™ã®ã§ã€ãŠæ°—è»½ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚</p>
                `;
            }
            
            document.getElementById('recommendation').innerHTML = recommendation;
            document.getElementById('planSuggestion').innerHTML = planSuggestion;
            document.getElementById('estimate').innerHTML = estimate;
        }
        
        function submitContactForm() {
            const formData = {
                companyName: document.getElementById('companyName').value,
                contactName: document.getElementById('contactName').value,
                email: document.getElementById('email').value,
                phone: document.getElementById('phone').value,
                meetingType: document.getElementById('meetingType').value,
                message: document.getElementById('message').value,
                diagnosisScore: document.getElementById('scoreText').textContent,
                recommendedPlan: getPlanFromScore(),
                answers: getAnswersText(),
                timestamp: new Date().toLocaleString('ja-JP')
            };
            
            if (!formData.companyName || !formData.contactName || !formData.email) {
                alert('å¿…é ˆé …ç›®ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚');
                return;
            }
            
            emailjs.init('aTvoZagCwtwRUj_ti');
            
            const submitBtn = event.target;
            submitBtn.disabled = true;
            submitBtn.textContent = 'é€ä¿¡ä¸­...';
            
            emailjs.send(
                'service_965a3ls',
                'template_79z1vyg',
                {
                    to_email: 'miraigoto34@gmail.com',
                    company_name: formData.companyName,
                    contact_name: formData.contactName,
                    from_email: formData.email,
                    phone: formData.phone,
                    meeting_type: formData.meetingType,
                    message: formData.message,
                    diagnosis_score: formData.diagnosisScore,
                    recommended_plan: formData.recommendedPlan,
                    diagnosis_answers: formData.answers,
                    timestamp: formData.timestamp
                }
            ).then(
                function(response) {
                    alert('ãŠç”³ã—è¾¼ã¿ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚\n3å–¶æ¥­æ—¥ä»¥å†…ã«æ‹…å½“è€…ã‚ˆã‚Šã”é€£çµ¡ã„ãŸã—ã¾ã™ã€‚');
                    document.getElementById('companyName').value = '';
                    document.getElementById('contactName').value = '';
                    document.getElementById('email').value = '';
                    document.getElementById('phone').value = '';
                    document.getElementById('message').value = '';
                },
                function(error) {
                    alert('é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ãŠæ‰‹æ•°ã§ã™ãŒã€ãƒ¡ãƒ¼ãƒ«ã§ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚\nmiraigoto34@gmail.com');
                    console.error('EmailJS error:', error);
                }
            ).finally(
                function() {
                    submitBtn.disabled = false;
                    submitBtn.textContent = 'è©³ç´°æ‰“åˆã›ã‚’ç”³ã—è¾¼ã‚€';
                }
            );
        }
        
        function getPlanFromScore() {
            const scoreText = document.getElementById('scoreText').textContent;
            const score = parseInt(scoreText.replace('%', ''));
            
            if (score >= 75) {
                return 'ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ—ãƒ©ãƒ³';
            } else if (score >= 50) {
                return 'ã‚¹ã‚¿ãƒ³ãƒ€ãƒ¼ãƒ‰ãƒ—ãƒ©ãƒ³';
            } else {
                return 'ãƒ©ã‚¤ãƒˆãƒ—ãƒ©ãƒ³';
            }
        }
        
        function getAnswersText() {
            const questions = [
                'å¾“æ¥­å“¡æ•°',
                'ç¾åœ¨ã®æº€è¶³åº¦', 
                'ã‚¤ãƒ™ãƒ³ãƒˆé–‹å‚¬é »åº¦',
                'ã‚¤ãƒ™ãƒ³ãƒˆå½¢å¼',
                'ã‚¤ãƒ™ãƒ³ãƒˆèª²é¡Œ',
                'ãƒªãƒ¢ãƒ¼ãƒˆãƒ¯ãƒ¼ã‚¯çŠ¶æ³',
                'æ¡ç”¨èª²é¡Œ',
                'å¹´é–“äºˆç®—',
                'æ–°ä¼ç”»ã¸ã®é–¢å¿ƒ',
                'æ˜ åƒåˆ¶ä½œã¸ã®é–¢å¿ƒ'
            ];
            
            let answersText = '';
            Object.keys(answers).forEach(q => {
                const questionIndex = parseInt(q) - 1;
                answersText += `${questions[questionIndex]}: ${getAnswerText(q, answers[q])}\n`;
            });
            
            return answersText;
        }
        
        function getAnswerText(questionNum, value) {
            const answerTexts = {
                '1': ['10åä»¥ä¸‹', '11-30å', '31-100å', '101åä»¥ä¸Š'],
                '2': ['éå¸¸ã«æº€è¶³', 'ã¾ã‚æº€è¶³', 'ã‚„ã‚„ä¸æº€', 'å¤§ã„ã«ä¸æº€'],
                '3': ['é–‹å‚¬ã—ã¦ã„ãªã„', 'å¹´1-2å›', 'å¹´3-6å›', 'æœˆ1å›ä»¥ä¸Š'],
                '4': ['é£²ã¿ä¼šãƒ»æ‡‡è¦ªä¼š', 'ãƒœãƒ¼ãƒªãƒ³ã‚°ãƒ»ã‚«ãƒ©ã‚ªã‚±', 'ã‚¹ãƒãƒ¼ãƒ„ç³»', 'æ±ºã¾ã£ãŸå½¢å¼ãªã—'],
                '5': ['å‚åŠ ç‡ãŒä½ã„', 'ãƒãƒ³ãƒãƒªåŒ–', 'æº–å‚™ã®è² æ‹…å¤§', 'åŠ¹æœãŒæ„Ÿã˜ã‚‰ã‚Œãªã„'],
                '6': ['å®Œå…¨å‡ºç¤¾åˆ¶', 'ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰', 'åŸå‰‡ãƒªãƒ¢ãƒ¼ãƒˆ', 'éƒ¨ç½²ã«ã‚ˆã‚Šç•°ãªã‚‹'],
                '7': ['å¿œå‹Ÿè€…ãŒå°‘ãªã„', 'ä¼æ¥­æ–‡åŒ–ãŒä¼ã‚ã‚‰ãªã„', 'å®šç€ç‡ãŒä½ã„', 'ç‰¹ã«èª²é¡Œãªã—'],
                '8': ['20ä¸‡å††æœªæº€', '20-50ä¸‡å††', '50-100ä¸‡å††', '100ä¸‡å††ä»¥ä¸Š'],
                '9': ['éå¸¸ã«é–¢å¿ƒã‚ã‚Š', 'ã‚„ã‚„é–¢å¿ƒã‚ã‚Š', 'ã‚ã¾ã‚Šé–¢å¿ƒãªã—', 'ç¾çŠ¶ç¶­æŒã§ååˆ†'],
                '10': ['éå¸¸ã«é–¢å¿ƒã‚ã‚Š', 'ã‚„ã‚„é–¢å¿ƒã‚ã‚Š', 'ã‚ã¾ã‚Šé–¢å¿ƒãªã—', 'ä¸è¦']
            };
            
            return answerTexts[questionNum] ? answerTexts[questionNum][value - 1] : value;
        }
        
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('option')) {
                const question = e.target.closest('.question');
                const questionNumber = question.dataset.question;
                
                question.querySelectorAll('.option').forEach(opt => opt.classList.remove('selected'));
                
                e.target.classList.add('selected');
                
                answers[questionNumber] = e.target.dataset.value;
                
                document.getElementById('nextBtn').disabled = false;
            }
        });
        
        updateProgress();
    </script>
</body>

</html>
